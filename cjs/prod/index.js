(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{RunEnv:()=>j,default:()=>F});const n=require("prop-types");var r=e.n(n);let o=()=>!0;class i extends Error{struct={propsName:"",value:void 0,expectedType:"",preciseType:""};name="ValidatorError";propsName;info;value;constructor(e,t,n,r){super(e),this.propsName=t,this.info=n,this.value=r}toString(){let e;if(this.info instanceof c||this.info instanceof i)return this.struct={propsName:this.info.propsName,value:"",expectedType:"",preciseType:""},this.info.toString();if(this.info instanceof Error){const t=this.info.message.match(/(?<=(`))([\[\]\w<>\d\.]+)(?=(`))/g);if(!t)return this.info.message;{const[n,r,o,i]=t;e={propsName:n,value:o,expectedType:i,preciseType:r}}}else e=this.info;this.struct=e;const{propsName:t,value:n,expectedType:r,preciseType:o}=e;return`属性:[${t}]的值等于['${n}'],期待为 ${r} 类型/值，实际类型/值： ${o} .`}}class c extends Error{name="ObjectValidatorError";source=[];propsName;constructor(e,t,n){super(e),this.source=n,this.propsName=t}toString(){const e={};return this.source.forEach((t=>{const n=t.toString(),{struct:{propsName:r}}=t;e[r]=n})),e}}const a=Function.call.bind(Object.prototype.toString),s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",u=Symbol.for("validatorDisplayName"),l=Function.call.bind(Object.prototype.hasOwnProperty);function f(e){if(null==e)return""+e;const t=p(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function p(e){const t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function y(e){function t(t,n,r,o,i,c){return c=c||r,null==n[r]?t?d(r,n[r],"非空","null/undefined"):null:e(n,r,o,i,c)}const n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function d(e,t,n,r){return new i(`${e} 验证失败`,e,{propsName:e,value:t,expectedType:n,preciseType:r})}function b(e){return y((function(t,n){const r=t[n];if(a(r)!==e){const t=f(r);return d(n,r,e,t)}return null}))}function h(e,t,n=!0){if(o())return null;let r={},a=null;for(const n in e)if("__tag"!==n&&l(e,n))try{if("function"!=typeof e[n]){const e=Error("验证函数类型错误");throw e.name="Invariant Violation",e}a=e[n](t,n,"","",null,s),r[n]=0==!!a||a instanceof c?a:new i(`${n} 验证失败`,n,a,t[n])}catch(e){r=e;break}return Object.values(r).filter((e=>1==!!e)).length>0?new Error(function(e){const t={};return Object.keys(e).forEach((n=>{let r=e[n];0!=!!r&&(r instanceof c||(r=r instanceof i?r:new i(`${n} 验证失败`,n,r)),t[n]=r.toString())})),JSON.stringify(t,null,2)}(r)):null}function m(e,t,n){!o()&&console.log(`Validator Error。 [typeSpec.__tag]:[${t.__tag}] =>`,n)}const g={extends:[],getTypeSpec:()=>"{}",extendsFactory:()=>{}},v=e=>{const[t,n]=e.match(/\[object (\w+)\]/)??[];return n},w=(e,t)=>[`${t}.${e}`,`${t}.${e}.isRequired`],x=($=e=>{const t=Date.parse(e);return"number"==typeof t&&!isNaN(t)&&t>0},y((function(e,t){const n=e[t];if($&&!$(n)){const r=f(n);return new Error(`${JSON.stringify(e)}-[${t}]-[${n}] is type ${r} , but expected value is test by Date.parse`)}return null})));var $;const N={buffer:b(a(new ArrayBuffer(0))),dataview:b(a(new DataView(new ArrayBuffer(0)))),uint8:b(a(new Uint8Array)),uint16:b(a(new Uint16Array)),uint32:b(a(new Uint32Array)),int8:b(a(new Int8Array)),int16:b(a(new Int16Array)),int32:b(a(new Int32Array)),float32:b(a(new Float32Array)),float64:b(a(new Float64Array)),uint8clamped:b(a(new Uint8ClampedArray))};function E(e){return function(t){function n(t,n,r){const o=n[r];return null==o?function(t,n){const r=t[n];if(a(r)!==e){const t=f(r);return new Error(`Invalid ${n} value is ${r} ,but expected ${e} but get ${t}`)}return null}(n,r):t?new Error(`The \`${r}\` is null/Undefined as required , but its value is ${a(o)}`):null}const r=n.bind(null,!1);return r.isRequired=n.bind(null,!0),r}()}const S={null:E(a(null)),undefined:E(a(void 0))},T={promise:b(a(new Promise((()=>{}))))},O={dateString:(A=/(\d){4}?-(\d){2}?-(\d){2}? (\d){2}?:(\d){2}?:(\d){2}?/,y((function(e,t){const n=e[t];if(A&&!1===A.test(n)){const r=f(n);return new Error(`${JSON.stringify(e)}-[${t}]-[${n}] is type ${r} , but expected value is test(/^${A}$/)`)}return null}))),date:x,...N,...S,...T};var A,_,j;(_=(globalThis||void 0).Promise.prototype).validator||(_.validator=function(e,t){if(!o()){const n=n=>{const r=t?t(n):n,o=h(e,r);return"object"==typeof n&&null!==n&&Object.defineProperty(n,"__props__error",{configurable:!1,enumerable:!1,get:()=>o}),o&&m&&m(0,e,o),n};return this.then(n)}return this.then((e=>e))}),function(e){e.dev="development",e.prod="production"}(j||(j={}));const P={env:j.dev};var L,D;L=[r(),O,{checkPropTypes:h,boolean:r().bool,function:r().func,shape:function(e){return y((function(t,n,r,o,a){const u=[],l=t[n],f=p(l);if("object"!==f)return d(n,l,"object",f);for(const t in e){const n=e[t];if(!n)continue;const c=n(l,t,r,o,a+"."+t,s);c&&u.push(new i(`${a} 验证失败`,a,c,l))}return u.length>0?new c(`验证错误：${a}`,a,u):null}))},arrayOf:function(e){return y((function(t,n,r,o,c){const a=[],u=t[n];if(!Array.isArray(u))return d(n,u,"[object Array]",p(u));for(let t=0;t<u.length;t++){const n=e(u,t,r,o,c+"["+t+"]",s);n&&a.push(new i(`${c} 验证失败`,c,n,u))}return null}))}},{extendsValidator:function(e,t){P[e]=y(t)},util:{createChainableTypeChecker:y,createExpectedTypeChecker:b,validatorLog:m},apiUtil:{WrapperApi:function(e,t){o();const n=(e,t)=>(Object.keys(e).forEach((r=>{const o=e[r];if("object"==typeof o){let i=t&&t[r];"object"!=typeof i&&(i={}),e[r]=n(o,i)}})),new Proxy(e,{get(e,n){const r=e[n];if("function"==typeof r){const e=t&&t[n]||{};return(...t)=>r(...t).validator(e.spec,e.handler)}return e[n]}}));return n(e,t)}},setEnv:e=>{P.env=e}}],Array.isArray(L)||(L=[L]),L.forEach((e=>Object.getOwnPropertyNames(e).forEach((t=>{const n=e[t];n[u]=t,P[t]=n})))),D=P,o=()=>"production"===D.env,function(e){if(!o()){const n={maxDepth:3,topName:"WsPropsType"},r=[null,void 0,1,"",!1,()=>{},Symbol.for(""),new Date,/\w/,Promise.resolve()],o=[[],{}];let i=[];const c={option:n},s=e=>((e=e.toLocaleLowerCase())===v(a({})).toLocaleLowerCase()&&(e="shape($)"),w(e,c.option.topName));r.forEach((e=>{const t=a(e),n=v(t);c[`exec${n}`]=function(e,n,r=!1){return i.find((e=>e.type===t))?.validator[Number(r)]||""}})),c.execAny=function(e,t,n=!1){return i.find((e=>e.type===a(null)))?.validator[Number(n)]||""},c.execUnknown=function(t,n,r=!1){const o=a(n);if(0==!!i.find((e=>e.type===o))){let t=v(o);if(t=t.toLocaleLowerCase(),1==!!e[t])return w(t,c.option.topName)[Number(r)]}return c.execAny(t,n,r)},c.execObject=function(e,t,n=!1,r=0,o){const s=i.find((e=>e.type===a({})))||{};if(0===Object.keys(t).length||r===o.maxDepth)return w(s.minType.toLocaleLowerCase(),c.option.topName)[Number(n)];const u={};if(Object.keys(t).forEach((i=>{const c=t[i],a=g.switchExec(c,i,t);a&&typeof a==typeof Function&&(u[i]=a(e,c,n,r+1,o))})),0===r)return u;const{validator:l}=s;return l[Number(n)].replace("$",JSON.stringify(u))},c.execArray=function(e,t=[],n=!1,r=0,o){const c=i.find((e=>e.type===a([])))||{};if(0===t.length||r===o.maxDepth)return c.validator[Number(n)];const s=g.switchExec(t[0]);return`${c.validator[Number(!1)]}Of(${s(e,t[0],!1,r+1,o)})${n?".isRequired":""}`},g.switchExec=function(e,t,n){const r=i.find((t=>t.type===a(e)));let o=null;const s=r?`exec${r.minType}`:null;if(s&&1==!!c[s])o=c[s];else{const r=g.extends.find((t=>t.test(e)));if(r){const{choice:i,execMap:a}=r,s=i(e,t,n);o=a[s]||c[s]}}return o||c.execAny},g.installType=function(e,t=!1){var n;n=[...r,...o],i=n.map((e=>{const t=a(e),n=v(t);return{type:t,minType:n,validator:s(n)}}))},g.extendsFactory=function(e){e.test&&"function"==typeof e.test&&e.choice&&"function"==typeof e.choice&&e.execMap&&g.extends.push(e)},g.__getID=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e.length;let n="";for(let r=0;r<10;r++)n+=e.charAt(Math.floor(Math.random()*t));return n},g.getTypeSpec=function(e,t=!0,r=n){r={...n,...r},c.option=r,g.installType();const o=g.switchExec(e)("",e,t,0,r);return"object"==typeof o&&(o.__tag=`'${g.__getID()}'`),JSON.stringify(o,null,2).replace(/\n/g,"").replace(/"/g,"").replace(/\\/g,"")},(t=g).extendsFactory&&t.extendsFactory({test:e=>{const t=a(new ArrayBuffer(0)),n=v(t);return!(!e||!e.buffer||Object.prototype.toString.call(e.buffer)!==t)||!(!e||!e.constructor||e.constructor.name!==n)},choice:(e,t,n)=>"execTypedArray",execMap:{execTypedArray:function(e,t,n=!1,r=0,o){const i=a(t),c=v(i).toLocaleLowerCase().replace("array","");return`${w(c,o.topName)[Number(n)]}`}}}),function(e){e.extendsFactory&&e.extendsFactory({test:e=>typeof e==typeof 1n,choice:(e,t,n)=>"bigint",execMap:{bigint:function(e,t,n=!1,r=0,o){const i=a(t),c=v(i).toLocaleLowerCase();return`${w(c,o.topName)[Number(n)]}`}}})}(g)}var t;e.PropsPlugin=g}(P);const F=P;module.exports.library=t})();
//# sourceMappingURL=index.js.map